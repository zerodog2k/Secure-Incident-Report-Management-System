{% extends "base.html" %}
{% block content %}
<div class="mb-3">
  <h3 class="mb-0">Audit Log</h3>
  <div class="text-secondary small">Admin only. Tracks key actions.</div>
</div>

<div class="card border-0 shadow-sm">
  <div class="table-responsive">
    <table class="table mb-0 align-middle">
      <thead class="table-light">
        <tr>
          <th>Time</th><th>User</th><th>Action</th><th>Incident</th><th>Details</th><th>IP</th>
        </tr>
      </thead>
      <tbody>
        {% for a in logs %}
        <tr>
          <td class="text-secondary small">{{ a.created_at.strftime("%Y-%m-%d %H:%M UTC") }}</td>
          <td>{{ a.user.email if a.user else "System" }}</td>
          <td class="fw-semibold">{{ a.action }}</td>
          <td>{% if a.incident_id %}#{{ a.incident_id }}{% else %}-{% endif %}</td>
          <td class="text-secondary">{{ a.details or "" }}</td>
          <td class="text-secondary small">{{ a.ip_address or "" }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% if pagination.pages > 1 %}
<nav class="mt-3">
  <ul class="pagination">
    {% for p in range(1, pagination.pages + 1) %}
      <li class="page-item {% if p == pagination.page %}active{% endif %}">
        <a class="page-link" href="{{ url_for('audit_log', page=p) }}">{{ p }}</a>
      </li>
    {% endfor %}
  </ul>
</nav>
{% endif %}

{% endblock %}
